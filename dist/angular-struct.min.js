(function(){angular.module("struct",[]).value("version","0.0.1")}).call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};admin.factory("BaseCollection",["uuid4","$rootScope","$timeout","EventEmitter",function(a,c,d,e){var f;return f=function(c){function f(b,c){var d=this;this.model=c,b||(b=[]),_.map(b,function(a){return d.push(new d.model(d,a))}),this._id=a.generate().replace(/-/g,""),this._subscriptions=new e(this),angular.extend(this,this._subscriptions.publicMethods)}return b(f,c),f.prototype.add=function(a){var b,c=this;return null==a&&(a="{}"),b=new this.model(this,JSON.parse(a)),this.push(b),d(function(){return c._subscriptions.attach(b),c._subscriptions.emit("add",b)})},f.prototype.remove=function(a){var b=this;return _.remove(this,a),d(function(){return b._subscriptions.emit("destroy",a),b._subscriptions.deattach(a)})},f.prototype.count=function(){return _.filter(this,function(a){return 1!==a._destroy}).length},f.prototype.toString=function(){return"BaseCollection:"+this._id},f}(Array)}])}.call(this),function(){admin.factory("BaseModel",["uuid4",function(a){var b;return b=function(){function b(b,c){this.storage=b,null==c&&(c=null),null!=c&&angular.extend(this,c,{newRecord:null==c._id}),this.newRecord&&(this._id=a.generate().replace(/-/g,"")),this.baseIndex=this._id}return b.prototype.newRecord=!0,b.prototype._destroy=0,b.prototype.isDestroyed=function(){return 1===this._destroy},b.prototype.remove=function(){return this.newRecord&&this.storage.remove(this),this._destroy=1},b.prototype.toString=function(){return this._id},b}()}])}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};admin.factory("EventEmitter",["$rootScope",function(b){var c;return c=function(){function c(b,c){this.base=b,this._subscriptions=null!=c?c:{},this.on=a(this.on,this),this.emit=a(this.emit,this),this.publicMethods={on:this.on}}return c.prototype.emit=function(a,c){return b.$emit(this.eventKey(c,a),c)},c.prototype.on=function(a,b){var c,d,e,f,g,h;for(null==(d=this._subscriptions)[a]&&(d[a]={callbacks:[],models:{}}),this._subscriptions[a].callbacks.push(b),g=this.base,h=[],e=0,f=g.length;f>e;e++)c=g[e],h.push(this.one(c,a,b));return h},c.prototype.attach=function(a){var b,c,d,e,f;e=this._subscriptions,f=[];for(d in e)c=e[d],f.push(function(){var e,f,g,h;for(g=c.callbacks,h=[],e=0,f=g.length;f>e;e++)b=g[e],h.push(this.one(a,d,b));return h}.call(this));return f},c.prototype.deattach=function(a){var b,c,d,e;d=this._subscriptions,e=[];for(b in d)c=d[b],e.push(this.off(a,b));return e},c.prototype.one=function(a,c,d){var e,f,g;return e=b.$on(this.eventKey(a,c),d),(f=this._subscriptions[c].models)[g=a.toString()]||(f[g]={bindings:[]}),this._subscriptions[c].models[a.toString()].bindings.push(e)},c.prototype.off=function(a,b){var c,d,e,f,g;for(c=this._subscriptions[b].models[a.toString()].bindings,g=[],e=0,f=c.length;f>e;e++)d=c[e],g.push(d());return g},c.prototype.eventKey=function(a,b){return""+this.base.toString()+":"+b+":"+a.toString()},c}()}])}.call(this);